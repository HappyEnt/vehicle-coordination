cmake_minimum_required(VERSION 3.0)

project("Kiel Webots Simulation")

# enable compile commands and copy into project root
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)

add_custom_target(
    copy-compile-commands ALL
    ${CMAKE_COMMAND} -E copy_if_different
        ${CMAKE_BINARY_DIR}/compile_commands.json
        ${CMAKE_CURRENT_LIST_DIR}
    )

# check whether WEBOTS_HOME environment variable is set
if(NOT DEFINED ENV{WEBOTS_HOME})
  # Check whether /Applications/Webots.app exists
  if(EXISTS "/Applications/Webots.app")
    set(ENV{WEBOTS_HOME} "/Applications/Webots.app/Contents")
  else()
    message(FATAL_ERROR "WEBOTS_HOME environment variable is not set and /Applications/Webots.app does not exist.")
  endif()
endif()

# Link with the Webots controller library.
link_directories($ENV{WEBOTS_HOME}/lib/controller)
include_directories($ENV{WEBOTS_HOME}/include/controller/c $ENV{WEBOTS_HOME}/include/controller/cpp ${CMAKE_SOURCE_DIR}/libraries)

add_subdirectory(controllers)
add_subdirectory(libraries)


